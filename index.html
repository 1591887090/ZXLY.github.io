<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>此页面已受保护</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #32CD32;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #32CD32;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #F8F8FF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">此页面已受保护</p>
                        <p><p><em><strong><font _msthash="96" _mstmutation="1" _msttexthash="44914012">请联系管理员获取权限</font></strong></em></p>
</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="请输入密钥"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="template_toggle_show"
                                title="template_toggle_show"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            我已知晓
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = 
            ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        ;
            const templateError = "template_error",
                templateToggleAltShow = "template_toggle_show",
                templateToggleAltHide = "template_toggle_hide",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"1438176126e1008668da6713f77b1fb532b236dd4c26a8925de9a598ccb92b966c9ceda25f6a878500f196325793927652409f02fff079e8fc7cd2b7215e773c0a53b006aa5ed6a20908f677035df9f19b9c24018c89a26bff824d8890a2276ac222f52deb2c40e05125a52adaeddd6dfb7ac68e78499875c9241d84a39052e4d1d1ae7cffa9aaa7b3aaddb328a6867cd4fffea32042438029f896306cd660cc7b14bdf56e519d604886822b7a53545d81cacdfaa41fcc6e405f652e37be7784006bc08bbb8398fe2c43a008e3a6c3fd4e233b83f1341ff570acb1c061fe3ee3bc8874aaae20e0f9c5e785df6f0ab5ca47402e9700fc77302cce8b857f80febb9f4366a84e153737ed3a43356f674e1efbade4c354fcc62c23a3ab7e599d909c5da6095f6dd54f13fdefcb1c3a44c02c9a7f44d45dd4fc683cc3906fd2bf7d225426ec9ebf6f025a66ca1b0320e814c4cab2c2786be44f6e7fad32756f0fd5d6752fc7b720b5c0793e7f26c42f61b5d4bd5e6636ec41d26f3ddce170ef5403ff30c8198741d5f655893de153f29df44c28a343094179bcb4d8a953711b986ae66514e8bfe61bf4490ffcb51f6cf44cf9b15b76d9530b76d38f224424b70cfd5968482f6ebcf8472e0bc8cf7563ae14252cd4ab618b4ca92d4480dbc974fc1421c64920cfb943f87f20ca52c7f29e14410befe6f440f9cd64cc93731e4bbab260b3d6e8bf2d2c72f1e88d65f9fe810f7f0b674933162f350b9725d9bd694b3262bac509519801c5c4ef6f799b9789be6eaed61ac0f205259044b7d97372ad97d591a9064b9fe07ab9105a55efd9a086c1a3d36e481801d12c1654ba0592d91c71a3eb6e29251096f3f0c6d89b97cf549a2a1883e9f14776f026750638c3c43ba3ffb629240f54f74073f8103115183283711c7fcd4168d7de7041ba1e6689c56f2cc92259f2d2778cb5763071f923efabae7a3329d03111cf9ebcf25083baaf004b53a144226ed3e02bef718744edae9440fba66b4dc47f97a56fc43e42e173847a262ebd600609572736216e5427a4cd2bd18422802fd3c192f1e223d49ef41df6dd55224c100e53865de15014e974a8e454bdf042a2518497b9d9f5d19ceb1faac8c92085ee2a47f09668a16084c7df3a94239b1c46a4df1eb122b4a9c4901a1c34efd0314bf33ddbadcee5e331da1505a1173d4056b6d6c9cef547a8c4b38831e3d937f87a7d92592de4e2564ec5ef0dfa2dda840cc4feeae1e78ef7aab3b2771725e615b7a311664a9fb94325705f2b2cc611dc32df55415ebf7bc4e4d4061d87e03cc7eddb8a44adea4edc3c69ad06fc7dabd37af30b653cb88810ad760da936896e849426b44dbf423cc1c7704c9f75346b64b7e317abed5f18ffe5ed19ec1e53fb3130831e77041768701118959e0c79ecefda0fc3a94f0d350603ebd3ac1a70ed7393e60b8f57da365c9cddefee897a95fd9cd1ea5b2313e4fb9baa2bee21a20e188db20fc2d3cc8d7eb0b0b3e525ba48678deca489a1d1b08112f43548376e9598bbae50f35cb2cd03f7eb4fc3c5321d56e39744210982d97de597c4fefe29262f888d9ae8e7072321a07919a1bdd7a3b0340aca7829ec59b9ca84d99bbda7e5af167d6d6199feb00114a979df4a13621870ace3f4f93e715ff097cf9c99b990a94f9f775627d06fc4f3bc25056e7a43013ee43fe2a4274a44d29ef518f062f270b5174fd5315aab176d384a9e7f768afa114b2dec812493b578de4adff7def3e892d8e044758ce31f3d4b51deac851f654e9355e187170d6dc0f69c114566674d7f5208e65a170a549921b821e065e30d15d37dbd30d5ac7ea62d9d6a3764811706aafb78b20e5345ecd6f133c9eba810c1c2b89c3abe2abc4c5d1bcc757fbe3ede9f33ffbca333fd4bfe10192d285781718cf0435dbca2ecb5f478044c79a8deae94a96a6643bb68c40edc56b53dd49f9e5023afc83ac79c85803918dc5e37aa13fafaf3de2d286276e5bfc4e9330aea6232fd553b835d4a99ada815a75edd8139bc0a6a38c57a4709c52a0aa86e6fbe2ee9da1ae7f238d0701a64199ce65cb3e587045d8abaa19ccaef6bd93f33d7dcdaf35530856d08419421dba3710ea262da3ea1e1a58d566216998bd2dc4f5c0a6665386ae107349d96f5df5d165c6d9c64b1aee9185cdfb0e91b9204d5e80811637cee555f7cb0044533a314ad4cd1324b20b638d48a2f02e61778eefb845eeb92f08eeb2c694cdb950a8fdc504d8f3ef8155064126e8c04f12f88db8a3e83c19dbbee41f6a28b238076287d8ff73130d403789bf31ba253b70892e07acd581dfdb83002831330ee81e3e57785370c3ad359ac16563a3d0ce4bdbeae45c2cce5c0c2a132d5200eb615332c952d6deeff467cc5bb82135d372c754c975444dc67b95343ced5ba048105c6da2584489f977ff293e77523adfd950e244192213c4406db7d6ce4e4764a97a46c63e535d6f0a2947c46e6f5c63ddb9b4025b9c21ec6edbbb574394328271bbc0d15c25d861858eaa2b5aac221192686fc009e91a31a83419e9ae1d413af9ae2809d0771106f07e2153b19b9087c0780bafb1612db0b8fb7212cc4e6bb005d8a3b28f8fbd10356333f497b5432551dce01301cc5a6a368b2df875e58ccfcd76249aacb3efc92535810d9b027debcdc22d042a263ecfe63764581acd0a519c96fc7c281f599fd8d46c1730806bd5b0e7eb8ac4275c7555859bc7b2dc4f8133aca3746fb0e19bb6d665f4b7917b4dd41bd0fbb5eb5c12e7cf8e18e41e8e66de93d5d366a6aa35aed47cc46048a11e749862a96408d12bad3d720bec09dc17f0c83569aabf0dd314a917ad0bbe22cb0b88c25d8e5fca431c588d0934dae75bdcae428db117678d22116f4deb8a94b78981c62618a3c8b85656f289fb1e986bde3ce3888dd2e6d16e831868d9da91fc63306e2ad4c0974e17ec54314bbe947e6b4a5b1897ffe7e7575fde067b334da7faa67b6e0d22cfc031ba4cb2dc669891399feb1ae71461ea9bfc464c0d86b0e9a57ea79bb211ad54f21f50cf003118a327e55be92b7db2900263d33857c83e20ae7d43e62661b91eb0e6c1486952203fb084988496bab2ad6ff4015f4dfb19e13109410430378a1905f126cf25e2279a38612dd6ccbccb7097d7101a74419d6c79f5ab33f775f268edeb7705a328dcb953669ec803250558fb69b5d64e151192046af43b5e8dd263f0a6143376328c1d06db6612fd3072e2886a1427bf783046c52f6d94e8352a735c895fca57b49ff06f028be30f1681dfcbff2eb8459cc0e5d6488a826db4e72b0a2fb0fb74606622ee416172affd6c515c723a19276cd64125e0b28ea6c10be7ba3eb51d0d468f040c9c15b2eb9e2c80f607b6f30760ef0075af36881c0da55fa1611b77d1374e847a8fd5d15e3859b81fd2c900e550560d4c07def92500a5aeb0565383f14deafd282704335c790d355d4d61b1a905b6383a179cfe94c15365808fc97b28209767f115dbd74673039ab58b57aa0e497a98b1dc3af3297bef29783e53e4cb52ca3d8456e64aa173ab532a03e808411df3c1a52d57f569c09524c64418cef5bd9e0d10f1767983932e17b44aceb0158231704357d9a16a5a62cd26c2a3ef0c93c5606490d1f34fe3e1ad7824f97fa34b746384535f3bb7d3249bfde699b823cb89903da5e0f2612e359b0bcb0ee1a4f3f6e7ed04a6a2aaea72b5c9e8508a0eb6849c86ccb0e68cd6ea6b15dded7417866489a2da1bb96f7bffca8233fc4a1cf1ef83d824d5bc651c9a72d60ccbaf13576e89f763292e4bbba2c772d017c7046e85fec1db67626c28ca19e3bf77eb34c921d98d831331367ae10fc6f70b6fae79823bc61e7a6afeeca81641bcdb37dca5d41d513d250abe1c362e3002c8604c9c1e53d8c1e4d300030193163f16d90b484b0372bfad75e36643b70eb78a3d323d50865cadb0d1803bab1b015952423a6605abca659503e7973d69ca6e85abaf960ed5029b0496403e60179e6faf58c03ab34e947b24a31ec698fc8249dedc18b8153d7c86ab548e370a2d8184987a443a03f0847a254b254ccc99471ddb660dbefcb73b835dc9d2d66e9cd85e6ef84fcb8c5c576e7eae47a195fdd1f668907bb4cbf9fc650f922c0474b9cc8ffc0a321d85cfe62aecb45f9b23cfc1216871f03614bfd337a0d1c58dd7130ecf2a880f0d26d84703115c844dbac1f77a56a0452ee3cfc35fc362cbc99497a3b361acc71cafc0a6fbf0ece7af6674af540c5aa9415ff504465c8a8332d25c1315db50f7f94157380e24896219ed023dcade6a03e2ab280a73ac0cd9e101ad9b7e02644c7b1f3144f8deff4afbd3d98a83d2039cd5219a317329b47be0e8a34fa9e8375e58a11f3889ca9c9091081507a9ce939251e0ba0f21a4735ce87ae4452dbef049f220af6bf82783b8ab1ee123fa943c1b13c7f8d43280a942f1d3d56601f2192b98b90e9d5d3b312ef10658bc4f165605b7fc01de954ac13358384f915faebbf16d477753fd48b7f05e4fa16a6901f0cc18703ebe65acf9907672639d294a8d2e34dc2391edf18ab11c04fb6e8d5fd1380b2962da15374459d984faa01927fcd0f6c68b463491ea4bba21b3103d16e612e38a5644b4484248c529d06bf975c2b6b741242ab5fab37393e03bb8e4fa5ec3c6e97f5ea087e9fa583148fd97dc3bf6989336b2602c426d77abd8b633d85f3d383fd5b4ec754714aaede8453fad12fc9823cb4e441e34bd4517d1238813b4e5c83eb74647317780fb3b42abe4be4cc6df55e6f16c5427493c98c4fdb115f2b30ba77fc5ab542cfc859f5239cae17f73b938c78a4ff9a071c915858b47cb782bfeca7713e13157e6818bc230577b17944bacf3e06c3c30018f71adfbac42be8b0f29425c215cc326cb967958ff91fd02eb0513021c449c936df0a3c85c8f22c585ac1364eddfcc7fcd9fbfdc3223454b982f1fdb5c62f778981902ce9965ab195820596fbdc3a63fa3838a04e31f5a21785ddc4e9c06d6c97b0c8ba7b79ebeca3bc0e6aae5869116beaecde7c884ff224a711a2cd2cf201c7f42cc5e95475d84b1c9ce789d0959744f209f5839107315b0400442746ca1ded159462148f0b9f8b123068976224123347e7dab1f76aee451cbaab9ab337feab4830c3c1b5ebc988ac948d0ce422cab1fc18c3b28345e080ffb4fe83f3698279cd70ddee3c772a4ada8b120178e800af8f109026fda1aa48656da524d0bf91f97c3e5e1e6bb53f70d2a36401a70094ccc0648c209a1b747a66c6ea50e673ebf830ab8b700ae07ba1d9e4a5284f1a721bcd676f1dfacce1688908d5927ffc67d8a0162958f3b43e8a55229d4ed1c97d26aa87111f6d0e3f579a13f6bb83f62d8e93e4b8616e2e22b979644e80aff172272e490a8c15e87ee4f82e5e4a82b769401a384ad7fb2bf4beebdc644a95535deb7198f26b21c6aa5f3fdfd23cad05b648f814bca1f12b55e07c6d117c19d6f0cdc1d76447eaed9c0dfbb394484c72d5e840784619d8b47f485edd117c72be98118979b6c653b869d7d61c234e2a0bcbc056ddcb461b327b7fa7a173da5045774d2efa6ae19e51062d7e4d07d818f10eb3eede5d77ce247e25720e57955ae9b3b99afedbbe8e39925089783faeae456b252f221c9e0eb95d2d1e0b11441675f48edcd700deb4958bcaebbc7ca30b508aa3d0998158a38787cd30082afc570b39de0d8b43ba7c7f638560bd423da9d986137b80f9f11e72754d60cddddffd11333b44c77498c5f062ec83cf3173918f5cabfbd6b4d349013ad830f4c9aba4a595eadc9cef8452ecce4c6118ec3cfb3325d11216884dd814dbf91e2efe8b7ca83da2b9593bf96f0b19d5439be84f090b885a574e7da905dbee67663d2924fa5bbbfd20314969599fd23c8e3a7a9233be27d9312dcda81ebce48a8fc4e5037b217d3fe259408d2078cf5d3a5118d3ee3af70c44cd41a71a398b9defe07c964ba4fafc66f01a4a982f012fa5a7d5c8da44ccb7207e644852d05f391ff8c9498fbdff23d18fa847c6de53d8268ce8f27777e36bb80c6e98787bf2923ad36efdd36d0ca58c16f296390d5c1e2c48c3612c0e671b466b3cf37a02bfa6b575717cf45a2766c4a3899c1155478d548272486cf4ccf3b10f7b1db4298170f22404e0a522c64811b8c22b60240ae235b3016bd913b06f792da815d58a749ec8d92bf4bc4af10f6bbda26ddf038675d8164ce75c7f1ae50e0862d9652cf31e75ee9d1fe2771186005e926ab03a9be9b661b4c9277ece04b37f6b9f82505e167be0fdbbd52430686fa7e73514bc77eefaaf56f4c0dfd3ac128d73dfeae995ca9d4a8b512a8bb6c23acb6aef2ce1f28d427eb2d7b521720a0da8e94efcbef96c008846582e15fd19c7d840fdc248af4c8ded392cceccbe65e627557ab5698e12fa9b3b0fa81fe850ab5fd067e27681a25eeb4bbced7164258aec777a5cc00b4f4e6e0d90444e1286d1cc316a1db67124ccd2fc1de7a794ce06594b4c230596d9d6d5aa2ed932a2db7abfd1bf23ab21b55268ab14a6cecb0da48aa825da715c179694692d5cf79c1520a95a7c51aec8f6be28c4f5893abdad7283c3984bfaad52bd67993ec656e058a087494d85056ddd8ccb52637e955792a077ae5fc4bc433b2cbea48141c537fa566782673d8fcd9d4b77f863d556aaac6d9320921f506897161d36ba0f34c76d5254588e6144aa5976d9f99eb23fcc09999a6ae2d2eaf8a6026931c0fbad5d3cb281016076edd694d34d53dea5beeaebd63f60b8e37ae3d5194a0908d410edf7a5812ff4cf40426b4968a74035e207287f402ca82cdc8e9bb8c9f86e9306afcc8624bb8d19e006a9672acc63d82c32e999b8781d9d37a79b5ec4e3813bef68a346c75b0562b090fb2ca3c4a978ba8a26b574acac1d7d3486d7319c77f33024ffa592e7b097be3cce34ffa92699e0d81e21e4a227f9d49373e415f4308dc42174a3c5f92626148e4b8de5179975ad93b1ff1c0b19b51c3aa9cec26a8d5d15e4cc80f23304561c6fa845981f2d2c358f5d9db79dc37a501cc3578b8246c9ed4709da27cab7f3db230df0369d18218e5c81f3c7f90f6a543e9c5fbf31d6c6f9c98818cc108a426ce2a94c203546c8d6a3395be3d5a2bb98f45294251bb4a37911e5b3b44c025b62b5b9251f1e2fe0e86b36977f93faeb8eb748024d5ba110b600df8467bc5972d2a58722807f5c8aae3977752c614c60b1b0fce0f6af17fd9b4ccfaf99e9ee8c4f6e0cc90ef33f6373d268beffe126e89562979c621dec0817480dd2ee05dd0d59897947f7c480cc5b1ee3f1aaeef7268e9f360989b61793c5df66295453646f4c6f88a7f9db803455999a73d52746cc848793accb0fcffd9b590b2cf56065736941662a51c2ffb51e13026495447b75c318b271fb7d0128751bbd89b75aa4c837bf4e141c56354cc260a9a4efe128679d2c5bf0dc6e935f24276e5569f3699a12309a95b281bf7b05ced7380ba1bf92710fc5fa54fe0f886eea7e63e3a9955a8d514ef161489b1d90228e642b7171fbf54f2b37c5f8385f5cbd0a919068e699b5ee9c62aed68f0ac8772a5879126c009f93c5af40804bbe84a916c831c290a82c69cc9de69ced802df1d6a9827b2930d1f669415c324405ce5f4ba293bb47ccb6f4fbcc265dd75ce87c9eaf9cd551eb6121c56a243583bf8e1d33a1c2c838b0f5bbc6a8d67d6c3c978dc772bee9988921561984f45d7753c2195f19294c8599b128b4f63df41fac4fa65db436c789c281193b95cee94b396a18566a3d081b00b7ba614cbb0af51ad3dc86ca34a8a09cfcfbc2989e9a22c9c587e26b2116ad0c402670036f010e7fa7369ea2a3836d26f2c09a395a7e48e6da00cb4b21cd1274d731518e8e09ef4fa371183e2e926a41eef3e521b3508872e8d0885f633a849452d0f026012b142ce42d37f07422a4e1d9c7ed977b8fce52b68e80c84ad7a0f563c8b76a886df71579d449f4f20d4a5ce33d4890c23ba3d9ca647c7b330b6993c7934a6e03d5f818085339123b16bf0daf0a09f75c6861edac16559e741f634a9968a79b65e4f1fa26b5f93928db64df515383cf66da6d044bacaa4d32cbbd7c072612d051c0f08af425621eab9e6d4d8bb1c5eb963f3b623329fdcdfe1e4b0d38b39657d5baa22062160f02cdabad6dbb76634bf2551449802961ea98a15ee4c55d8fd674b321ab2b8e9f662553acdd1371da349e32c31edb406bb3115be1a7a2e6994714fcd288b54e1f9d6771c07f7339dd19eb5fcae09fa304578e6f48e8ebf2a0b06eb3dd3f0f52bc99b4c207ce92d53992d1147a335b7d73be6133dfdb799e783768e88b6a4ee662646dfe67d98901fc5496d954c98a25b277458f619341225f4ed6b288365c2d5a7b2e68983e7bbaae35247fe1ddfeba9b2e3171572ae19447cf1da7e944499e9edd473ce600f4e811d86370328ea661e448f9aa1452cb2590006df91943a446d1f7ceb0192e4a79682d7ac49f9dd4a3cf39ef3673c1ed74b0fd89a87c3d89e5d5b861fb36c716d9c73eab8ae2d87d8b3064c5b478dea87a7b9f178a8e1c838ecaefb94bb804ee35fb0e6dfaa313030e75651e3276585430fa08098a5a2ef98e876cd2d34f6f631988a28ce64657e399c501d6a7c8ef2989bbf0555de5572c8c0bb62c0c0375bb7a9b434137c8ba87a50cee72c18786d878684fe8fec410e6a47265ca704de06ac4c7f44a3bcd1c3c934f46a1d37dedbc99c1b4cfa520ab26be10ab1ccca732b9522c8ca47224364031d7f3017537b360e0519cfbcfe2546b85691317ee8f337e89e4e21651888c90bec2e86348b96bc97c90a851e25877a507af495ca0b315697ce89d93215c37a505ce73b7440c37a6469f67b9fb8f25b5f1ab35c393e516cd24f3b41f13b4c497ca30db2e1712e16a6b55c3411b6fd3e69d5196ce7df1ed775632e5f68685b72cd7babbb4415c081c2d7aa060bfefeb575fc5c5499c7de481993bd7fab7d8d78cc505f319c4327b6bab708ac13b5b06534874c489946c8d633cb8877e842f5b36a3521bd3b94a80e42ccef6a5f42a9139bcd6b4a2febe5a198b26842ad887caab920cad78bcfd2ef4f315876f9edf8b437527f4a7db96902d14f62f4cd707285ecbff576d23c4516c8925ec40aea4ec12a9ad751291a28488a6d8355ad72ce40e952b82b22d2321e6348cb8b96fac87eaa4546500813f6d3c6219acda1fc1aff084b79ee50f9c8f023a3b42fe2a680b8cc257b7d4fd1e454cda5e8b1d56ce8cfa95548a9cc0da5a2750c3f625629e883dc60ef378de40ca4b5dd03a936ef7d81296ea2e7c649827f7a912e4898aaaee29b62e1f7e35330899ed932314579e5e5ee14c5438d603dc3761515572c31d5fbf6d5df3bf3b192cfa6c24883dba6ec3378377a0efcccb3c9b8bae59e4cc7ce960394ec4ee741867e8667745e39cde34aa2a4621f75eb424dd4b6c5db2428bb7a5bbf414bc0f85ad8169d648be5606d28d98fed33e59614983761ac3a6b4c60a17375837a6961a1fce1ed040d2866ded2c89537a2cd6e9694ccee6afd148fa88af66948b818f21ef7b571db3444c367417c0e868c093a7c167d0fc562f89effb3902aa11a02d44ceef5950e65a4d1a8ab8b4460df8e67a6aca364b90a14124fd2853873699310418c803adf4110ed0cf3e3af42e774e7eb1e6850711128fbf78ea953e83d071bf4eb43cd0465bec258e4767ce4390b9648f3164c26971124b0a64e734cec674ed49c87de2a08823861104fa15f8b433ca769147440ebba2c008f3e99e49bb981768c75bf92f6c1dabffeb9b71a28c1a6072ebcdd075c1a4eb2f5dd95337ea085faeaf1bf0f4ab2f77a5aef50b7213df8f53f1badfdd4dbb326a3311a52e72e54623deca0230060af8e641cd27bb6a6b59e0c51200cf0792c93ad756d8b28f9fa50a89909951da77d88e19113a3795a09481b7508341da7692d65cdee812653cbcc897ab7aecf26962ba2a955266f81f99e0088f0a736d38efb4b326399eaa61c86f460447d798b219464df90bf507f4da783b70dc47833ab01d5d9e75293bc093474af87ae9d027d573d3f290dd87515f64b17c2b47545bac8d7099f7ea9e9a81cdca6885133a2220c75ecf58ecd485f6898865e016000a310cf4580f18ccf18df4737164fd186e101d791a345b068f12ecb807ca1c8ba5de7cd6310a325d47a8f6c76ebd039fce3c4942523cf315561091afc20882b8afbbbb16d772809806889d4982366f04cce17b88120aaf0a0e6cff3abb97299ee44456a30f8ff3794a96d8bcd54d67cede7d5a59b4b308302c5e58c46d74613f36347e9b8c0c2fc70ad9129db16bbb4d969bfc2c987ad8e2144986049849653cd966d3c5706ef775cf00df04c1f32b87932ab231618a539763be99e218d2b3b2549674dd97b49ed1c8106a9d5ec7291332c89195ecd034dd7ea7fd90357cd4eb055625706ce3104b0aca69f88573bf34e76db4f4d6d42bedb6c1a57c7d4fede3e19adc6b2ccb2074ae62a9b312b187ca166bb801e2b86b163c9dfdc7622789ac64f3242e8cbae74d97c34bbac0d1082fe87b62f791d36f1ecc5661981da508ac9a5243913ba4ce1c4dd2cdf9582c205ac44ade0d6f70fff54af0b6fc829f1be740e655d7c3e384cb712005bb61cccf69f7bab22c6978ee9f23c75ddbc5b4e2ece2eb0b6311f3ebc2c54e1e17873b92de7bb25f49b3b07650d021a426127a619329737c723e489d24848dfe306530faf1a964b69908639b1beee3fbafd2d81942c1ea6f3c116dec7ce2770e782516211a6ee88be647b9d5dfe18dbddd4d818b3fab9f2411ef5d7937c76ec68c83815f842e90215b52836077ed7a8523e2c31b134fab81a067a1fd464128e0c1dc4053ae7524829a772d0dc997d9da4412206d45f8e0159341ab75bd6534721014a9f98da19807df632ddc44c0110d575dc9e2677823c899208270df51a9acbcfbf0f42285b85a6f0b9020179fab9f7f3db7d3ec2f9657f1c43e2d1633df5fdbd8fbc90d11ae9a892935416276c3fc5cf7211f81e8b3b524d5ef0a32495e165c256c0e4b6a5a1636906a2ff3e39f3747b806aa7bd04a829987a0d820a6bba10b5efdfa1324e74d7e632c848decbb3b24a5b8f1790745734a57019baf735e7cb702a1e5c8de42112df8fc409fd221dc83102c8548187a6a3b0ff35b57afefaf91cdb3eec18aecdf45358e0dd756538cb351e7df553d3a46781c2849c9e573d656c6d33592233cb20190165df0ea290778acdee56e531445f5def7901a73a39e398281d808f19c97041a43a1254e5adc86080c5d1803f30c5fc0fefab3aec0582fc997448fd9e449fa414d02210453de05b7bdab78ec6bda99eb3c1c4b65b443f629a3f042b899b8312085886249909b5bb4b7d0bb961e18c582b32b23aceb5fde52041020e80b9232f30deb29460c788fa838d3ce7f24cb6d52a58f57a08d863d131057a2481ddb048d024d673aa0125273992963c8ddc9029ebf93cd151091e1d979ca69d0be04e53d021e42e4c06fac3a0fff3b86712bc85ba06fe32c363ecfb159a372edb61dbefa2c54a3fe976089b51762889a28ee6554a0fd16bbfffb804784483ba34d92f3ca5038ce8cef56559741b040ba97271cd2806b185fa6bae34a11ce5b30203eca01df54f5134764f519c4c1fcab86ca8771d9dc7cbd77edca54c0ed2598c0046faa50196b91c5eaa2a595546c0f05be069dbe518e737651520c5d238d303d0bb3ecd1d1c5df8ee4224814d8112adbd526b17d34fc2c9e2a927316cdb89cb15079cbf2e18b9920dce414da825f522471fce142dc22e0ce4db3f7426e5a04db3368c4c8438495b9ae2597d1beffd8e31a9326514af1aa82e79dc064f38dfd1ba30802cee82b5d3883b1d13f6dc67189a19dd92b5381a36070d5ec578ed96af276d6d7968170cf3fa046e8a6dfa57507cb519091a4d1ccd83f5724b31d3b43ec3ca76fd3ba14c38b58c95a0c70b0a812b988a5502ec03e207d867e4d90d6d7c6582b04add4e322d6f1cd179cdff742a09f4bed5e8b8480cb2a93ca1ffec874fb096cd250ef2e5594cf976bb3da0a881448205d16156671ec13b2ed50f59ff524649730ac7632350fedad78ccfb0defd126f5564287806e9d4fa3ae683f38e8e2bc701de8a2767abeb46a224b3266022744dab47018cd158733172da7b5fbb333e338f29f2b3070d3964cc86050f34a7180425782b155412694ace19f6a0769330e446e0164c4aaac93e613d21b0e8fb7bda503de6fc04f06c898fc6f1a6114a048eda9190d40c6eeefab7fcee4e02b94ebd1ff1e0a7028174cdeb31582f7492c56bcf7dcba9232229aa2daf1a15ed4d9802f340ee828148f0219185f56d269162a617a003d2b5edca0317349fda4d88bd798d57e12037c226c616bcd1e719933537a61c8680b5c791d0bbad264dcba098344261934f7415a028ca46c665531a7fcd2c94fd044194f55a2733f01021c9538d5a43a17c0110f259812ac7bd72441de058fbacbd3c3b99a555ca44c4f6f9684e72efe9244d58d79c8c63d3840f72bcf8b3b1a30dd8db4dd27566e01000628e88494ff4329472ba868160e3f12f5a4c9be9d698540c689fd93cd4630f6b52d47e6aeccedfa5c08ddc4a33b87908a2ccc90ae6e279f38226601f358d2e1e553ef83f5259db40145accab54016a409ab80a7615e18cd39e1fc3473337aade8dcf7b0fb4291bbb526d19965e7afa5de52b341d5bcfc4519dae63622a491b6e6a3ecf574da8f6f159810df6c0eba3c5ea2405cc116809d5c2a9c0d9c6168c6414700e3117f81502bfa289f6ebebb56395525ca42d567426e2f9939e6a97864d0d3f208040f261283f4638ac8e57179370f41665ec14593eac2dc0d3aa5b3f8e01257da43495644c5d459a0589a17981ca22a9616379405562e24f9034bf472b2d3f65559848e5fd63922beb956592fa8dea85066bd94c38b68c1d4bfcae6e94949033cd7cbacedbc6a89c3310c9df0a09874064cde3212e0c62a18bb897269b7c8d589562a30289dc59d1a46a47ece20194f150916634ef524aa5de51240a61ef855ba0ea182a2d049c991ff10692268bc9b5078cd55d6f12e3827b299a5df9acc10ee0242f45478a3e1f09c455ef73547fc2fc72b52fcbbd74e906106dd73e712a14fc06cb1505b60bee98212c220c03136dfd1de3962f5e9f3efa7ba331008dcd77c16fbc3c1a4457fb8de23d810e2573d5bcd126bcdc7df31b624269f94f881726ca5c7269fff7701f6783a1cc7c9869c0cfd43c23b160fedf63caa5c9f0fe0c77cd5405afec6eb830cbeb3d545123fe47bbe4d91ee505280c543a10d6144daf5a378e63e610222a684252072c0dec97ce5eead3a67bda88bf68eb0a16105df9ca3b009bee6ae13d0a6535ef9afeedeb57008e67b28e1f8ce441741745456d818a59eea9ad70242d4a78f510af5c0fcdbc67f3e368b1d335ce73db4eb35ccfe06d81dc4b3ac86a751d30a53674daf8f1c38629275eb8ec5dc982f3ef2bea554b23ba22fd2e335045630b9b10e075554ad6bab16b2023bdf2a6c6efd95d0edeb99082ea03989bf6fb3a895c7188f371e8d601f8e02ec29ca4e9212f73ebce529b6344a76187f0e65e77cd14ee3b4d7242c0b7726a0b40388c7e7ba246d1c00ab6d218c8b282159efbb851abbec139a7b8bcb6b45e751079a33c7f52fdca6ce82f5e3207fd483799f50e4431ab6ef7ace436d09a89eee311697dc81c84b52a7865242db1c378d4af56c44f345212298af261b1c1286fa8930caabf4fe13de4f819c993524cb2d1feacb4b3b67478a8d7df1ca5083d52d870a23a20148e59cd702b085d883323f483dc85902f1e2cd86bfdf4103c84d8fe188a9269bbc8a7bb993ac6f3d2e34a56750a55fac1c50eba1e4036e786914b5a37dbb0ae4684de06400b207cacb0b2d0cc3773669c477bc23837c61866f771fa07f84dde67a52276c3f20d64bc73f10db8fd637344d5a5121c1fcb1e0b83a54e833da419edbe376b049b7dbb606b6d1b6e8d54f3c3694aa6e16619dc763c5edeb1c4e1e8206db612aeaf09b4e50f08db1cd0d19c3c9d65c2c16463c103292461b850f2bf51434f229565d916e07bc944db72d5084ac68b3c667aeb83f3fbbd227704c4f2e14c800b3308a234e77315f846b1c4a056bdb7ce777f254005e1861fafd8387c1f16759e6df3dfeef156fbd7e56492cf13b6ceba72f9e8a51880147e7cb93d51b8991c561ff3fb3ade2ee2d31479fd631a7088762b81a435a5fb1f13f2a44ea1e03ae5a91f61e434b5e124662eaa6704bce4a359c03f195d42aed1ed5a6c052f613a6539a90b6fabe91c4dc016a12205adb660feab86dee77edda7b0cc955b5dd8d28d2b074c10df1216807e3ba6c9ee965b7cf62ae7d6ae738ae2b4dc40f5d51fe377c4b8a60d5ad4e03b29d73a4dc291de77c279c267fece6a76592a4adc858b64aa920384df1f954e01f3ff59d9765ec24c446f6b172b6b4f36a2ea455b81b557e8b8cdbacca83d777f6d93e2e0ca58c6663f7fd0a198bf41ebdcea32c210b2406ce3f698abe3accdceeeafd99b73f0e71d95833e25cddc79872198231725e33ff9ca3c64ba916d7326c9f7ede0faab6fd7716a346e6fec5767efd5a1f081f273c9834a63d4b2ef8b71eb077e85ba8512d52fec53c1d398a275933c1e1c2e7b0d00ab5ddcd3074edad65983fd882b9722661e2e722156a43f2e629f288ea2823925d2c3cc3ecb57a7e1b08b16d2246df40817000313e4e5bbe0727e9311e7962a84c4a54f61055f9b1b25aec7ff7db440abbbb594480017cdcdca5b3eeadf5571457b22a42dcad556c8f51a88609d1829d403fe27508a2920de65e697de4dc324b404aaef23d8e742ace6219b2d58706b90f05904259762366421d747444b21faee35d3e154612fdd7605a65b378b65320d470e03e1a18b9a48c4fe86f7d295bad7b8ca77ea7c15753140f0b54085e81809d7c7dfc9fb0169813472ac1578bd8cdeff413054861d8129cb835bf7f61703b7dde84931dd8aa5d4e3976de43413e5a7825fdd7fcb2fadef038a328209153597d9fb3d0107173d1b02a89236cc82f421173439a50b522d7e97bd013f9bc532cb07b8d9d875c20b9bfb8049ee8baafac91f5fcb2a47c27de4fc86f780942781cf69e3e8ee8564fa5eddd94b6e3cb71668040aa03a7ad36096bd9ce9e78d634669c7a56d1ce3d6a42b6cc4f09c6a3ee6e4d963929e43d3a2fdad6bc2f46e6741c593f03d58ca48f78949286c71ebc491a25e31db403e5b0f52b52ae073c85b7e0308fb5b9373e79d8854f088d5291089c32d6de137810618b96ddb4804ac6e9b0c95a485469a4895ebc0584e531271641aa4c121c28ca46213e55e2c8c7ce8ba108fcd9d31de5effbe55a37540b22caf6c44d418d1943646f4767e0407fefaf6569d84c84f94ea01af587704c78b6f7c0fc3aee97f5e741e11fbb4ca6769b9fd3d7e5e705c867928702746fb221b6b492d56b99762411d70de2de7bb250661035b78874ef63a37d805211e50a2b3e98e258fa3d881b30eb22399f5b43c034f42b74681fd25500064fb0c9dd7a398d022dc9cf1f249643d77417470256cd12fa3530bcee8c5982a117e25e22bf6522835e89c45e487466778b1c7265bb7e17e36d9431d070783670bb95175e1604cfb928bcda762569b1e43ad9629890401af13aed4eca8b3cbd15cf63f8cd20ef92a2d8b8688731735681ce5172903b25de5127bb8d8f07f2426c23c493beb89bb080718529244b050bd401898994779aac02013d7ca1bff7c6b6c1086f8584260362c353e2d0a3db7a70dc1e0609972f6a433bc752865a98e9e3cb947751d1d4bf1a439d9482157480d43c4a2f1803ad299828caade005bc12fb52559f6e7b1d3e82c896e013b64523fa0aa37562e72f94bbffbad4b1852c9bdde86d4229aee1b354e504cf247497d96cd5cf771efbac269b01fc32b82a98ed99210485d68e9e75ba1458f94ab4573bbd74f2564c025fbb50883f7ce3a9ef50d6c153fcbb5eb5cb35ac74f6dc5ca8b4e6925cf478966e5d8d0d557f72e452e69ff0459d60826ef1d4aa7ef6aaefd8c66115c0993a1168aba75e07cb132b3d379edadab65b8ea8c988d5aec39b907f0441a76367ea285ad8f9dbc2438089884673e3fe42b8f37c07a03433341041877942deaf42ef5e261a9a58bdee09c92db930153c6d8fee119f37281ab65c967b096b47d298ea7faa908f76e92dad9f7c3fc1a46c1308b8ccbea6d9e76a5a2546c451d98037504d1ab9bfc90b61dccff7523f877afdb4b504e83c9a4f943f24341cca81e9a7c776754a5359373baa69e29beb4ce691b7f3f97e8c13e9be7fcb950e3542c3756e284fd404e082c4ed34f8ee5b531ac3ec5f52a77fed1aa185e6068602d8e0e96e11ca863411f00fd462dda2e587e2af270dbd8a6e97ed97d329394c865bc1c4cff467ccaa611aa6bf00f832e67ec43c9c44243bb086b32674bf6844112a1ff110ee1e26c98f41c87730e88df13fd99ca55e4d18d51d9292db92b9f6ce50c27476f1578d3e28ae20f5fb88919aeb8d545f30e86f1c8619377c580728364d34958c5baa25944b6afef7a91174c9c2b1aa24443b83a328bc9c559818c8d53049015ee7bc58fc93a7892a9442abfd80b5c6f9657aa41c9b851cfe623bbc82a7215ef34b8e89360c157f870a8c6c269ea5b1b6c5b703598268d27e2855e411256c80fcd8c5d8f8432486b699adc8c5139bb43ba12337a5660b67990937506bce961fbf7d2ba491b8611c05f38d217cbd5717093612af5ce822262c0af2b382fc8f2e3560d674568e25d77841c6e925441d0d3a9cbd1d83df441c284cb63ade5f52e6b86133e2ab0c5672fcff7f2f1e37102405df2703875c35054c647e61b19aa4226986f1d23d2e65d15d46020279b5f6b46884575c820f3520eecb16ece5654b54b298b72b96f17adc2c1ffcfe6e691187d1cb97cf191a16b3656cdf","isRememberEnabled":true,"rememberDurationInDays":"0","staticryptSaltUniqueVariableName":"8450a6104dbd84e6184a5b36e56d5e3e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
